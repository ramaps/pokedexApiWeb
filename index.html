<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pok√©dex Pixel Art</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/html5-qrcode@2.3.8/minified/html5-qrcode.min.js"></script>
    <style>
            * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #ff0000, #cc0000);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 25px;
        }

        .header h1 {
            font-family: 'Press Start 2P', cursive;
            color: #ffcc00;
            text-shadow: 3px 3px 0 #2a75bb, 5px 5px 0 #000;
            margin-bottom: 15px;
            font-size: 1.8em;
        }

        .search-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            align-items: center;
        }

        #pokemonInput {
            padding: 12px 20px;
            font-size: 16px;
            border: 3px solid #2a75bb;
            border-radius: 50px;
            width: 100%;
            max-width: 400px;
            text-align: center;
            font-family: 'Press Start 2P', cursive;
            font-size: 10px;
        }

        #pokemonInput:focus {
            outline: none;
            box-shadow: 0 0 10px #ffcc00;
        }

        .search-buttons-row {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }

        #searchBtn, #qrBtn, #prevBtn, #nextBtn, #randomBtn {
            padding: 10px 15px;
            font-size: 9px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-family: 'Press Start 2P', cursive;
            transition: all 0.3s;
        }

        #searchBtn {
            background: #2a75bb;
            color: white;
        }

        #searchBtn:hover {
            background: #1c5a9c;
            transform: translateY(-2px);
        }

        #qrBtn {
            background: #28a745;
            color: white;
        }

        #qrBtn:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        #prevBtn, #nextBtn {
            background: #ffcc00;
            color: #2a75bb;
        }

        #prevBtn:hover, #nextBtn:hover {
            background: #e6b800;
            transform: translateY(-2px);
        }

        #randomBtn {
            background: #9c27b0;
            color: white;
        }

        #randomBtn:hover {
            background: #7b1fa2;
            transform: translateY(-2px);
        }

        .pokedex {
            background: #dc0a2d;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border: 8px solid #b30720;
        }

        .pokedex-screen {
            background: #8bac0f;
            border: 8px solid #2a75bb;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .screen-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            align-items: start;
        }

        .pokemon-image {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 25px;
            min-height: 280px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 3px solid #306230;
        }

        #pokemonSprite {
            width: 180px;
            height: 180px;
            image-rendering: pixelated;
            object-fit: contain;
        }

        .loading {
            font-family: 'Press Start 2P', cursive;
            color: #2a75bb;
            font-size: 11px;
        }

        .pokemon-info {
            color: white;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .pokemon-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0;
            padding-bottom: 12px;
            border-bottom: 2px solid #ffcc00;
        }

        #pokemonName {
            font-family: 'Press Start 2P', cursive;
            color: #ffcc00;
            font-size: 16px;
            text-transform: capitalize;
        }

        .pokemon-id {
            font-family: 'Press Start 2P', cursive;
            color: #2a75bb;
            background: white;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 12px;
        }

        .pokemon-types {
            display: flex;
            gap: 8px;
            margin-bottom: 0;
        }

        .type-badge {
            padding: 6px 12px;
            border-radius: 15px;
            font-family: 'Press Start 2P', cursive;
            font-size: 8px;
            color: white;
            text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.3);
            border: 2px solid #000;
        }

        .pokemon-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            padding: 12px;
            border-radius: 8px;
            border: 2px solid #306230;
        }

        .stat {
            text-align: center;
        }

        .stat label {
            font-family: 'Press Start 2P', cursive;
            font-size: 7px;
            color: #ffcc00;
            display: block;
            margin-bottom: 4px;
        }

        .stat span {
            font-family: 'Press Start 2P', cursive;
            font-size: 10px;
            color: white;
        }

        .pokemon-abilities, .pokemon-stats-detailed {
            margin-bottom: 0;
        }

        .pokemon-abilities h3, .pokemon-stats-detailed h3 {
            font-family: 'Press Start 2P', cursive;
            font-size: 9px;
            color: #ffcc00;
            margin-bottom: 8px;
        }

        .abilities-list {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .ability {
            background: rgba(255, 255, 255, 0.2);
            padding: 6px 10px;
            border-radius: 12px;
            font-family: 'Press Start 2P', cursive;
            font-size: 7px;
            text-transform: capitalize;
            border: 1px solid #000;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 6px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 6px 10px;
            border-radius: 8px;
            border: 1px solid #306230;
        }

        .stat-name {
            font-family: 'Press Start 2P', cursive;
            font-size: 7px;
            color: #ffcc00;
        }

        .stat-value {
            font-family: 'Press Start 2P', cursive;
            font-size: 9px;
            color: white;
        }

        .pokedex-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            gap: 10px;
        }

        .led-indicators {
            display: flex;
            gap: 12px;
        }

        .led {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 2px solid #333;
        }

        .led.red {
            background: #ff4444;
            box-shadow: 0 0 8px #ff4444;
        }

        .led.yellow {
            background: #ffcc00;
            box-shadow: 0 0 8px #ffcc00;
        }

        .led.green {
            background: #00ff00;
            box-shadow: 0 0 8px #00ff00;
        }

        .qr-hint {
            text-align: center;
        }

        .qr-hint small {
            font-family: 'Press Start 2P', cursive;
            font-size: 7px;
            color: #ffcc00;
        }

        .error-message {
            background: #ff4444;
            color: white;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            margin-top: 15px;
            font-family: 'Press Start 2P', cursive;
            font-size: 9px;
            border: 2px solid #cc0000;
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.95);
        }

        .modal-content {
            background: linear-gradient(135deg, #2a75bb, #1c5a9c);
            margin: 5% auto;
            padding: 0;
            border-radius: 20px;
            width: 95%;
            max-width: 400px;
            border: 5px solid #ffcc00;
            box-shadow: 0 0 30px rgba(255, 204, 0, 0.5);
        }

        .modal-header {
            background: #ffcc00;
            padding: 20px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            font-family: 'Press Start 2P', cursive;
            color: #2a75bb;
            font-size: 14px;
            margin: 0;
        }

        .close-btn {
            background: #dc0a2d;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 20px;
            cursor: pointer;
            font-family: 'Press Start 2P', cursive;
            transition: all 0.3s;
        }

        .close-btn:hover {
            background: #b30720;
            transform: scale(1.1);
        }

        .camera-options {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 15px 0;
            padding: 0 20px;
        }

        .camera-option-btn {
            background: #ffcc00;
            color: #2a75bb;
            border: none;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-family: 'Press Start 2P', cursive;
            font-size: 8px;
            transition: all 0.3s;
        }

        .camera-option-btn.active {
            background: #28a745;
            color: white;
        }

        .camera-option-btn:hover {
            transform: translateY(-2px);
        }

        .scanner-container {
            position: relative;
            padding: 20px;
            background: #000;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #qrReader {
            width: 100%;
            max-width: 280px;
            border-radius: 10px;
            overflow: hidden;
        }

        .scanner-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 200px;
            border: 3px solid #ffcc00;
            border-radius: 15px;
            pointer-events: none;
            z-index: 10;
        }

        .scanner-line {
            position: absolute;
            width: 100%;
            height: 3px;
            background: #ff0000;
            top: 20%;
            animation: scanLine 2s ease-in-out infinite;
        }

        @keyframes scanLine {
            0%, 100% { top: 20%; opacity: 1; }
            50% { top: 80%; opacity: 0.7; }
        }

        .camera-error {
            text-align: center;
            color: white;
            padding: 20px;
            display: none;
        }

        .camera-error h3 {
            font-family: 'Press Start 2P', cursive;
            font-size: 12px;
            margin-bottom: 15px;
            color: #ffcc00;
        }

        .camera-error p {
            font-family: 'Press Start 2P', cursive;
            font-size: 8px;
            margin: 8px 0;
            line-height: 1.5;
        }

        .retry-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 20px;
            cursor: pointer;
            font-family: 'Press Start 2P', cursive;
            font-size: 9px;
            margin-top: 15px;
            transition: all 0.3s;
        }

        .retry-btn:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .permission-help {
            background: rgba(255, 204, 0, 0.2);
            padding: 15px;
            margin: 10px;
            border-radius: 10px;
            text-align: center;
        }

        .permission-help p {
            font-family: 'Press Start 2P', cursive;
            font-size: 8px;
            color: #ffcc00;
            margin: 5px 0;
            line-height: 1.4;
        }

        .modal-instructions {
            padding: 15px;
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 0 0 15px 15px;
        }

        .modal-instructions p {
            color: white;
            font-family: 'Press Start 2P', cursive;
            font-size: 8px;
            margin: 8px 0;
            line-height: 1.5;
        }

        /* Colores para tipos Pok√©mon */
        .type-normal { background: #A8A878; }
        .type-fire { background: #F08030; }
        .type-water { background: #6890F0; }
        .type-electric { background: #F8D030; }
        .type-grass { background: #78C850; }
        .type-ice { background: #98D8D8; }
        .type-fighting { background: #C03028; }
        .type-poison { background: #A040A0; }
        .type-ground { background: #E0C068; }
        .type-flying { background: #A890F0; }
        .type-psychic { background: #F85888; }
        .type-bug { background: #A8B820; }
        .type-rock { background: #B8A038; }
        .type-ghost { background: #705898; }
        .type-dragon { background: #7038F8; }
        .type-dark { background: #705848; }
        .type-steel { background: #B8B8D0; }
        .type-fairy { background: #EE99AC; }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 1.4em;
            }
            
            .pokedex {
                padding: 15px;
            }
            
            .screen-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .pokemon-image {
                min-height: 200px;
                padding: 20px;
            }
            
            #pokemonSprite {
                width: 140px;
                height: 140px;
            }
            
            .search-buttons-row {
                flex-direction: column;
                align-items: center;
            }
            
            #searchBtn, #qrBtn, #prevBtn, #nextBtn, #randomBtn {
                width: 180px;
            }
            
            .modal-content {
                margin: 10% auto;
                width: 95%;
            }
            
            .scanner-overlay {
                width: 180px;
                height: 180px;
            }
            
            .modal-header h2 {
                font-size: 12px;
            }
        }

        .pixel-art {
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>POK√âDEX PIXEL ART</h1>
            <div class="search-container">
                <input type="text" id="pokemonInput" placeholder="N√∫mero (1-1025) o nombre..." autocomplete="off">
                <div class="search-buttons-row">
                    <button id="searchBtn">BUSCAR</button>
                    <button id="qrBtn">ESCANEAR QR</button>
                    <button id="prevBtn">ANTERIOR</button>
                    <button id="nextBtn">SIGUIENTE</button>
                    <button id="randomBtn">ALEATORIO</button>
                </div>
            </div>
        </header>

        <!-- Modal para el esc√°ner QR -->
        <div id="qrModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>ESCANEAR C√ìDIGO QR</h2>
                    <button id="closeModal" class="close-btn">&times;</button>
                </div>
                
                <div class="camera-options">
                    <button id="frontCamera" class="camera-option-btn active">C√ÅMARA FRONTAL</button>
                    <button id="rearCamera" class="camera-option-btn">C√ÅMARA TRASERA</button>
                </div>
                
                <div class="scanner-container">
                    <div id="qrReader"></div>
                    <div class="scanner-overlay">
                        <div class="scanner-line"></div>
                    </div>
                    <div id="cameraError" class="camera-error">
                        <h3>‚ùå ERROR DE C√ÅMARA</h3>
                        <p>No se pudo acceder a la c√°mara</p>
                        <p>1. Haz clic en el √≠cono de üîí o üì∑</p>
                        <p>2. Selecciona "Permitir"</p>
                        <p>3. Recarga la p√°gina si es necesario</p>
                        <button id="retryCamera" class="retry-btn">REINTENTAR</button>
                    </div>
                </div>
                
                <div class="permission-help">
                    <p>üí° Busca el √≠cono de c√°mara en la barra de direcciones</p>
                    <p>üì± En m√≥vil: Toca "Permitir" cuando aparezca</p>
                </div>
                
                <div class="modal-instructions">
                    <p>üéØ Apunta al c√≥digo QR</p>
                    <p>üî¢ Debe contener n√∫meros del 1 al 1025</p>
                </div>
            </div>
        </div>

        <main class="pokedex">
            <div class="pokedex-screen">
                <div class="screen-container">
                    <div class="pokemon-image">
                        <img id="pokemonSprite" src="" alt="Pok√©mon" class="pixel-art" style="display: none;">
                        <div id="loading" class="loading" style="display: none;">Cargando...</div>
                    </div>
                    
                    <div class="pokemon-info">
                        <div class="pokemon-header">
                            <h2 id="pokemonName">---</h2>
                            <span id="pokemonId" class="pokemon-id">#---</span>
                        </div>
                        
                        <div class="pokemon-types" id="pokemonTypes">
                            <span class="type-badge type-normal">---</span>
                        </div>
                        
                        <div class="pokemon-stats">
                            <div class="stat">
                                <label>ALTURA</label>
                                <span id="pokemonHeight">---</span>
                            </div>
                            <div class="stat">
                                <label>PESO</label>
                                <span id="pokemonWeight">---</span>
                            </div>
                        </div>
                        
                        <div class="pokemon-abilities">
                            <h3>HABILIDADES</h3>
                            <div id="pokemonAbilities" class="abilities-list">
                                <span class="ability">---</span>
                            </div>
                        </div>
                        
                        <div class="pokemon-stats-detailed">
                            <h3>ESTAD√çSTICAS</h3>
                            <div id="pokemonStats" class="stats-grid">
                                <div class="stat-item"><span class="stat-name">HP</span><span class="stat-value">---</span></div>
                                <div class="stat-item"><span class="stat-name">ATAQUE</span><span class="stat-value">---</span></div>
                                <div class="stat-item"><span class="stat-name">DEFENSA</span><span class="stat-value">---</span></div>
                                <div class="stat-item"><span class="stat-name">AT.ESP</span><span class="stat-value">---</span></div>
                                <div class="stat-item"><span class="stat-name">DEF.ESP</span><span class="stat-value">---</span></div>
                                <div class="stat-item"><span class="stat-name">VELOCIDAD</span><span class="stat-value">---</span></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="pokedex-controls">
                <div class="led-indicators">
                    <div class="led red"></div>
                    <div class="led yellow"></div>
                    <div class="led green"></div>
                </div>
                <div class="qr-hint">
                    <small>üí° Pok√©dex completa - 1025 Pok√©mon</small>
                </div>
            </div>
        </main>
        
        <div id="errorMessage" class="error-message" style="display: none;">
            Pok√©mon no encontrado
        </div>
    </div>

    <script>
        class Pokedex {
            constructor() {
                this.currentPokemonId = 1;
                this.maxPokemonId = 1025;
                this.qrScanner = null;
                this.isScanning = false;
                this.currentCamera = "user";

                this.initializeEventListeners();
                this.loadPokemon(this.currentPokemonId);
            }

            initializeEventListeners() {
                document.getElementById('searchBtn').addEventListener('click', () => this.searchPokemon());
                document.getElementById('qrBtn').addEventListener('click', () => this.openQRScanner());
                document.getElementById('prevBtn').addEventListener('click', () => this.previousPokemon());
                document.getElementById('nextBtn').addEventListener('click', () => this.nextPokemon());
                document.getElementById('randomBtn').addEventListener('click', () => this.loadRandomPokemon());
                document.getElementById('closeModal').addEventListener('click', () => this.closeQRScanner());
                document.getElementById('retryCamera').addEventListener('click', () => this.openQRScanner());
                
                document.getElementById('frontCamera').addEventListener('click', () => this.switchCamera('user'));
                document.getElementById('rearCamera').addEventListener('click', () => this.switchCamera('environment'));
                
                document.getElementById('pokemonInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.searchPokemon();
                });

                document.getElementById('qrModal').addEventListener('click', (e) => {
                    if (e.target === document.getElementById('qrModal')) {
                        this.closeQRScanner();
                    }
                });
            }

            switchCamera(cameraType) {
                this.currentCamera = cameraType;
                document.getElementById('frontCamera').classList.toggle('active', cameraType === 'user');
                document.getElementById('rearCamera').classList.toggle('active', cameraType === 'environment');
                
                if (this.isScanning) {
                    this.closeQRScanner().then(() => {
                        setTimeout(() => this.openQRScanner(), 500);
                    });
                }
            }

            async openQRScanner() {
    const modal = document.getElementById('qrModal');
    modal.style.display = 'block';
    
    try {
        // Usar la API nativa de c√°mara
        const stream = await navigator.mediaDevices.getUserMedia({ 
            video: { facingMode: "environment" } 
        });
        
        const video = document.createElement('video');
        video.srcObject = stream;
        video.setAttribute("playsinline", true);
        video.style.width = "100%";
        video.style.borderRadius = "10px";
        
        const scannerContainer = document.getElementById('qrReader');
        scannerContainer.innerHTML = '';
        scannerContainer.appendChild(video);
        
        await video.play();
        
        // Mensaje instructivo
        const instructions = document.createElement('div');
        instructions.innerHTML = '<p style="color: white; text-align: center; font-family: Press Start 2P; font-size: 8px;">üì∑ C√°mara activada - Usa app externa para QR</p>';
        scannerContainer.appendChild(instructions);
        
    } catch (error) {
        console.error("Error c√°mara:", error);
        this.showCameraError();
    }
}
                    console.log("üì∑ Intentando iniciar c√°mara:", this.currentCamera);
                    
                    await this.qrScanner.start(
                        { 
                            facingMode: this.currentCamera
                        },
                        config,
                        (decodedText) => {
                            this.onQRScanSuccess(decodedText);
                        },
                        (error) => {
                            // Ignorar errores de escaneo normales
                        }
                    );
                    
                    console.log("‚úÖ Esc√°ner iniciado correctamente");
                    
                } catch (error) {
                    console.error("‚ùå Error al iniciar c√°mara:", error);
                    this.showCameraError();
                    
                    // Intentar con c√°mara frontal si falla la trasera
                    if (this.currentCamera === "environment") {
                        setTimeout(() => {
                            this.switchCamera('user');
                            this.openQRScanner();
                        }, 1000);
                    }
                }
            }

            onQRScanSuccess(decodedText) {
                if (!this.isScanning) return;
                
                console.log("‚úÖ QR escaneado:", decodedText);
                
                const pokemonId = parseInt(decodedText.trim());
                
                if (!isNaN(pokemonId) && pokemonId >= 1 && pokemonId <= this.maxPokemonId) {
                    this.isScanning = false;
                    this.closeQRScanner();
                    this.currentPokemonId = pokemonId;
                    this.loadPokemon(pokemonId);
                } else {
                    console.log("‚ùå QR no v√°lido");
                }
            }

            async closeQRScanner() {
                this.isScanning = false;
                
                if (this.qrScanner && this.qrScanner.isScanning) {
                    try {
                        await this.qrScanner.stop();
                        this.qrScanner.clear();
                        console.log("üî¥ Esc√°ner detenido");
                    } catch (error) {
                        console.error("Error al detener esc√°ner:", error);
                    }
                }
                
                document.getElementById('qrModal').style.display = 'none';
            }

            showCameraError() {
                document.getElementById('cameraError').style.display = 'block';
            }

            async searchPokemon() {
                const input = document.getElementById('pokemonInput').value.trim();
                if (!input) return;

                this.showLoading();

                try {
                    let pokemonId;
                    
                    if (!isNaN(input)) {
                        pokemonId = parseInt(input);
                        if (pokemonId < 1 || pokemonId > this.maxPokemonId) {
                            throw new Error('N√∫mero no v√°lido');
                        }
                    } else {
                        const response = await fetch(`https://pokeapi.co/api/v2/pokemon/${input.toLowerCase()}`);
                        if (!response.ok) throw new Error('Pok√©mon no encontrado');
                        const data = await response.json();
                        pokemonId = data.id;
                    }

                    this.currentPokemonId = pokemonId;
                    await this.loadPokemon(pokemonId);
                    document.getElementById('pokemonInput').value = '';

                } catch (error) {
                    this.showError();
                }
            }

            async loadPokemon(id) {
                this.showLoading();

                try {
                    const response = await fetch(`https://pokeapi.co/api/v2/pokemon/${id}`);
                    if (!response.ok) throw new Error('Pok√©mon no encontrado');
                    
                    const data = await response.json();
                    this.displayPokemon(data);
                    this.hideError();

                } catch (error) {
                    this.showError();
                }
            }

displayPokemon(pokemon) {
    document.getElementById('pokemonName').textContent = this.capitalizeFirst(pokemon.name);
    document.getElementById('pokemonId').textContent = #${pokemon.id.toString().padStart(3, '0')};
    
    const sprite = document.getElementById('pokemonSprite');
    
    // VERSI√ìN CORREGIDA - Sin operador ?.
    let pixelSprite = pokemon.sprites.front_default;
    
    // Verificaci√≥n segura de sprites pixelados
    if (pokemon.sprites.versions) {
        const gen5 = pokemon.sprites.versions['generation-v'];
        if (gen5) {
            const blackWhite = gen5['black-white'];
            if (blackWhite && blackWhite.animated && blackWhite.animated.front_default) {
                pixelSprite = blackWhite.animated.front_default;
            }
        }
    }
    
    sprite.src = pixelSprite;
    sprite.style.display = 'block';
    
    this.displayTypes(pokemon.types);
    document.getElementById('pokemonHeight').textContent = ${(pokemon.height / 10).toFixed(1)} m;
    document.getElementById('pokemonWeight').textContent = ${(pokemon.weight / 10).toFixed(1)} kg;
    
    this.displayAbilities(pokemon.abilities);
    this.displayStats(pokemon.stats);
    
    this.hideLoading();
}

            displayTypes(types) {
                const typesContainer = document.getElementById('pokemonTypes');
                typesContainer.innerHTML = '';

                types.forEach(typeInfo => {
                    const typeElement = document.createElement('span');
                    typeElement.className = `type-badge type-${typeInfo.type.name}`;
                    typeElement.textContent = typeInfo.type.name.toUpperCase();
                    typesContainer.appendChild(typeElement);
                });
            }

            displayAbilities(abilities) {
                const abilitiesContainer = document.getElementById('pokemonAbilities');
                abilitiesContainer.innerHTML = '';

                abilities.forEach(abilityInfo => {
                    const abilityElement = document.createElement('span');
                    abilityElement.className = 'ability';
                    abilityElement.textContent = abilityInfo.ability.name.replace('-', ' ');
                    abilitiesContainer.appendChild(abilityElement);
                });
            }

            displayStats(stats) {
                const statsContainer = document.getElementById('pokemonStats');
                const statItems = statsContainer.querySelectorAll('.stat-item');
                
                const statMapping = {
                    'hp': 0,
                    'attack': 1,
                    'defense': 2,
                    'special-attack': 3,
                    'special-defense': 4,
                    'speed': 5
                };

                stats.forEach(stat => {
                    const index = statMapping[stat.stat.name];
                    if (index !== undefined && statItems[index]) {
                        statItems[index].querySelector('.stat-value').textContent = stat.base_stat;
                    }
                });
            }

            previousPokemon() {
                if (this.currentPokemonId > 1) {
                    this.currentPokemonId--;
                    this.loadPokemon(this.currentPokemonId);
                }
            }

            nextPokemon() {
                if (this.currentPokemonId < this.maxPokemonId) {
                    this.currentPokemonId++;
                    this.loadPokemon(this.currentPokemonId);
                }
            }

            loadRandomPokemon() {
                const randomId = Math.floor(Math.random() * this.maxPokemonId) + 1;
                this.currentPokemonId = randomId;
                this.loadPokemon(randomId);
            }

            showLoading() {
                document.getElementById('loading').style.display = 'block';
                document.getElementById('pokemonSprite').style.display = 'none';
            }

            hideLoading() {
                document.getElementById('loading').style.display = 'none';
            }

            showError() {
                document.getElementById('errorMessage').style.display = 'block';
                this.hideLoading();
            }

            hideError() {
                document.getElementById('errorMessage').style.display = 'none';
            }

            capitalizeFirst(string) {
                return string.charAt(0).toUpperCase() + string.slice(1);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            new Pokedex();
        });
    </script>
</body>
</html>
